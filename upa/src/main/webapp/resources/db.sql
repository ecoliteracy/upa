/*To Remove all things*/
DROP TABLE IF EXISTS upa.upa_alert_message;
DROP TABLE IF EXISTS upa.upa_hand_scan_record;
DROP TABLE IF EXISTS upa.upa_hand_scan;
DROP TABLE IF EXISTS upa.upa_user_salary_type;
DROP TABLE IF EXISTS upa.app_user;
DROP TABLE IF EXISTS upa.upa_org_salary_pattern;
DROP TABLE IF EXISTS upa.upa_organization;
commit;

DROP TABLE IF EXISTS upa.upa_org_salary_pattern;
DROP TABLE IF EXISTS upa.upa_organization;
CREATE TABLE upa.upa_organization (
  ORG_SEQ INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  ORG_TYPE VARCHAR(3) NOT NULL,
  ORG_NAME VARCHAR(50) NOT NULL,
  TZ_CODE VARCHAR(3) NOT NULL,
  CREATED_DATE DATETIME NOT NULL,
  LAST_MODIFIED_DATE DATETIME NOT NULL,
  PRIMARY KEY (ORG_SEQ) USING BTREE
)
ENGINE=InnoDB DEFAULT CHARSET=utf8;
  
CREATE TABLE upa.upa_org_salary_pattern (
  ORG_SP_SEQ INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  ORG_SEQ INT(10) UNSIGNED NOT NULL,
  FIRST_DATE DATE NOT NULL,
  LAST_DATE DATE NOT NULL,
  TZ_CODE VARCHAR(3) NOT NULL,
  CREATED_DATE DATETIME NOT NULL,
  LAST_MODIFIED_DATE DATETIME NOT NULL, 
  KEY OIG_SP_ORG_IDX (ORG_SP_SEQ, ORG_SEQ),
  PRIMARY KEY (ORG_SP_SEQ) USING BTREE,
  FOREIGN KEY (ORG_SEQ) REFERENCES upa.upa_organization(ORG_SEQ)
  )
  ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*
app_user
*/
DROP TABLE IF EXISTS upa.app_user;
CREATE TABLE upa.app_user (
  USER_SEQ INT(10) UNSIGNED NOT NULL AUTO_INCREMENT ,
  USER_ID VARCHAR(20) NOT NULL,
  USER_PASSWORD VARCHAR(20) NOT NULL,
  USER_LAST_LOGIN_DATE DATETIME NULL,
  ORG_SP_SEQ INT(10) UNSIGNED NULL,
  TZ_CODE VARCHAR(3) NOT NULL,
  CREATED_DATE DATETIME NOT NULL,
  LAST_MODIFIED_DATE DATETIME NOT NULL,
  PRIMARY KEY (USER_SEQ) USING BTREE
  )
  ENGINE=InnoDB DEFAULT CHARSET=utf8;

insert into upa.app_user (USER_SEQ, USER_ID, USER_PASSWORD,  USER_LAST_LOGIN_DATE,  ORG_SP_SEQ, TZ_CODE,  CREATED_DATE, LAST_MODIFIED_DATE)
values(1,'KIWASAKI', 'welcome1',  sysdate(), null, 'US3', sysdate(),  sysdate());
commit;

select * from upa.app_user;

DROP TABLE IF EXISTS upa.upa_user_salary_type;
CREATE TABLE upa.upa_user_salary_type (
  USER_SEQ INT(10) UNSIGNED NOT NULL,
  USER_SAL_TYPE_SEQ INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  SALARY_AMT DECIMAL(10,2) NULL,
  SALARY_CURRENCY_CODE VARCHAR(3) NULL,
  EXEMPT_IND INT(1) NULL, 
  PAY_PERIOD_TYPE VARCHAR(3) NULL,
  FIRST_DATE DATE NOT NULL,
  LAST_DATE DATE NOT NULL,
  TIME_ON_BREAK TIME NOT NULL,
  TZ_CODE VARCHAR(3) NOT NULL,
  CREATED_DATE DATETIME NOT NULL,	
  LAST_MODIFIED_DATE DATETIME NOT NULL, 
  PRIMARY KEY (USER_SAL_TYPE_SEQ),
  KEY fk_appuser_sal_type (USER_SEQ),
  CONSTRAINT fk_appuser_sal_type FOREIGN KEY (USER_SEQ) REFERENCES upa.app_user (USER_SEQ) ON DELETE CASCADE ON UPDATE CASCADE
  )
  ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*
upa_hand_scan
*/
DROP TABLE IF EXISTS upa.upa_hand_scan_record;
DROP TABLE IF EXISTS upa.upa_hand_scan;

CREATE TABLE upa.upa_hand_scan (
  HEADER_SEQ INT(10) UNSIGNED NOT NULL AUTO_INCREMENT primary key,
  USER_SEQ INT(10) UNSIGNED NOT NULL UNIQUE,
  FIRST_DATE DATE NOT NULL,
  LAST_DATE DATE NOT NULL,
  TOTAL_PRTCP_IN_MIN INT(5) NULL,
  REM_HOUR_IN_MIN INT(5) NULL,
  WORKING_HOUR_IN_MIN INT(5) NOT NULL,
  TZ_CODE VARCHAR(3) NOT NULL,
  CREATED_DATE DATETIME NOT NULL,
  LAST_MODIFIED_DATE DATETIME NOT NULL,
  #FOREIGN KEY (USER_SEQ) REFERENCES upa.app_user(USER_SEQ)
  CONSTRAINT fk_appuser_handscan FOREIGN KEY (USER_SEQ) REFERENCES upa.app_user (USER_SEQ) ON DELETE CASCADE ON UPDATE CASCADE
  )
  ENGINE=InnoDB DEFAULT CHARSET=utf8;


CREATE TABLE upa.upa_hand_scan_record (
  HEADER_SEQ INT(10) UNSIGNED NOT NULL,
  RECORD_SEQ INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  SCAN_DATE DATE NOT NULL,
  SCAN_IN_TIME TIME NULL,
  SCAN_OUT_TIME TIME NULL,
  PARTICIPATION_TIME TIME NULL,
  TZ_CODE VARCHAR(3) NOT NULL,
  CREATED_DATE DATETIME NOT NULL,
  LAST_MODIFIED_DATE DATETIME NOT NULL,
  PRIMARY KEY (RECORD_SEQ) USING BTREE,
  FOREIGN KEY (HEADER_SEQ) REFERENCES upa.upa_hand_scan(HEADER_SEQ)
  )
  ENGINE=InnoDB DEFAULT CHARSET=utf8;
  

/*
ERROR/ALERT MESSAGE CODE
*/
DROP TABLE IF EXISTS upa.upa_alert_message;
CREATE TABLE upa.upa_alert_message (
 MESSAGE_SEQ INT(10) UNSIGNED NOT NULL AUTO_INCREMENT primary key,
 MESSAGE_CODE VARCHAR(3) NOT NULL,
 MESSAGE_TYPE VARCHAR(3) NOT NULL,
 LANGUAGE_CODE VARCHAR(2) NOT NULL,
 MESSAGE_VALUE VARCHAR(500) NOT NULL,
 TZ_CODE VARCHAR(3) NOT NULL,
 CREATED_DATE DATETIME NOT NULL,
 LAST_MODIFIED_DATE DATETIME NOT NULL,
 KEY MESSAGE_IDX (MESSAGE_CODE, LANGUAGE_CODE)
 )
ENGINE=InnoDB DEFAULT CHARSET=utf8;

insert into upa.upa_alert_message (MESSAGE_SEQ,  MESSAGE_CODE,  MESSAGE_TYPE,  LANGUAGE_CODE,  MESSAGE_VALUE, TZ_CODE,  CREATED_DATE, LAST_MODIFIED_DATE)
values(1,'DUP', 'ERR',  'EN', 'The entered value is already existed.', 'US3', sysdate(),  sysdate());
commit;


